<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="src/styles/main.css">
  <link rel="stylesheet" href="src/styles/modelos.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>

  <title>TMI</title>
<link rel="icon" href="src/assets/favicon/tmi.ico" type="image/x-icon">


</head>

<body>

  <nav>
    <input type="checkbox" id="menu-toggle">
    <label for="menu-toggle" class="menu-icon">&#9776;</label>
    <div class="logo">THE MODEL ISSUE</div>
    <ul class="menu">
        <li><a href="index.html">INICIO</a></li>
        <li><a href="agenciaTMI.html">TMI AGENCIA</a></li>
        <li><a href="modelos.html">MODELOS</a></li>
        <li><a href="academiaTMI.html">TMI ACADEMIA</a></li>        <li><a href="semodeloTMI.html">APLICA PARA SER MODELO TMI AGENCIA</a></li>
        <li><a href="contacto.html">CONTACTO</a></li>
    </ul>
</nav>

  <div class="redes">
    <a href="https://instagram.com/themodelissue" target="_blank" title="Instagram">
      <i class="fab fa-instagram"></i>
    </a>
    <a href="https://wa.me/584128703811" target="_blank" title="WhatsApp">
      <i class="fab fa-whatsapp"></i>
    </a>
  </div>

  <header>
    <h1>MODELOS FEMENINAS UNIVERSALES</h1>
    <div class="subtitle">DISPONIBLES PARA </br>MODA, COMERCIAL, PASARELA</div>
  </header>
  <section>
    <div class="divider flex justify-center gap-4 my-4">
      <button id="btnMujeres" class="filter-btn px-6 py-2 rounded-full font-bold bg-black text-white border-2 border-white hover:bg-white hover:text-black transition">Mujeres</button>
      <button id="btnHombres" class="filter-btn px-6 py-2 rounded-full font-bold bg-black text-white border-2 border-white hover:bg-white hover:text-black transition">Hombres</button>
    </div>
  </section>
  <main>

    <!-- Galería de modelos -->

    <section id="gallery" class="gallery-2x2"></section>
  </main>







  <footer class="bg-black bg-opacity-80 text-white py-6">
</main>

<script>
(async function() {
  const gallery = document.getElementById('gallery');
  if (!gallery) return;

  // Carga JSON
  const res = await fetch('src/data/modelos.json', {cache: "force-cache"});
  const modelos = await res.json();

  // Crea elementos del DOM respetando tu estructura CSS
  function createModelCells(m) {
    // Photo cell
    const photoWrap = document.createElement('div');
    photoWrap.className = 'cell-genero';
    photoWrap.setAttribute('data-genero', m.genero || 'mujer');

    const photoCell = document.createElement('div');
    photoCell.className = 'cell';

    const linkPhoto = document.createElement('a');
    linkPhoto.href = `detalle.html?id=${encodeURIComponent(m.id)}`;

    const modelPhoto = document.createElement('div');
    modelPhoto.className = 'model-photo';

    const imgContainer = document.createElement('div');
    imgContainer.className = 'img-container';

    const img = document.createElement('img');
    // mostrar solo el primer nombre en alt para accesibilidad
    const firstNameAlt = (m.titulo || m.nombre || '').toString().trim().split(' ')[0] || (m.titulo || m.nombre || '');
    img.alt = firstNameAlt;
    // imagen real en data-src (se cargará con IntersectionObserver)
    img.dataset.src = (m.fotos && m.fotos[0]) || m.foto || '';
    img.className = 'lazy';
    img.loading = 'lazy';
    img.decoding = 'async';

    // placeholder SVG (gris claro) para evitar layout shift y dar feedback inmediato
    const placeholder = 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="14" viewBox="0 0 20 14"><rect width="100%" height="100%" fill="%23e5e7eb"/></svg>';
    img.src = placeholder;

    // cuando la imagen real termine de cargar, ocultamos el overlay y marcamos como cargada
    function markLoaded() {
      try {
        if (overlay) {
          overlay.style.transition = 'opacity 300ms ease';
          overlay.style.opacity = '0';
        }
        img.classList.remove('lazy');
        img.setAttribute('data-loaded', 'true');
      } catch (e) {
        // safe
      }
    }
    img.addEventListener('load', () => {
      // si el src actual es el placeholder, no ocultamos el overlay aún
      if (img.getAttribute('data-src') && img.src === img.getAttribute('data-src')) {
        markLoaded();
      } else if (!img.getAttribute('data-src')) {
        // si no hay data-src, es imagen directa
        markLoaded();
      }
    });

    const overlay = document.createElement('div');
    overlay.className = 'img-overlay';

    imgContainer.appendChild(img);
    imgContainer.appendChild(overlay);
    modelPhoto.appendChild(imgContainer);
    linkPhoto.appendChild(modelPhoto);
    photoCell.appendChild(linkPhoto);
    photoWrap.appendChild(photoCell);

    // Info cell
    const infoWrap = document.createElement('div');
    infoWrap.className = 'cell-genero';
    infoWrap.setAttribute('data-genero', m.genero || 'mujer');

    const infoLink = document.createElement('a');
    infoLink.href = `detalle.html?id=${encodeURIComponent(m.id)}`;

    const infoCell = document.createElement('div');
    infoCell.className = 'cell';

    const modelInfo = document.createElement('div');
    modelInfo.className = 'model-info';

    const infoOverlay = document.createElement('div');
    infoOverlay.className = 'model-info-overlay';

    const h2 = document.createElement('h2');
    // mostrar solo el primer nombre en el título (mayúsculas)
    const firstName = (m.titulo || m.nombre || '').toString().trim().split(' ')[0] || (m.titulo || m.nombre || '');
    h2.textContent = firstName.toUpperCase();
    h2.style.position = 'relative';
    h2.style.zIndex = '3';

    modelInfo.appendChild(infoOverlay);
    modelInfo.appendChild(h2);

    // Mostrar solo los tres atributos principales en orden: cabello, peso, altura
    if (m.atributos) {
      const keys = ['cabello', 'peso', 'altura'];
      keys.forEach(key => {
        if (m.atributos[key]) {
          const a = document.createElement('div');
          a.className = 'model-attr';
          a.textContent = m.atributos[key];
          a.style.color = '#fff';
          a.style.fontSize = '0.9rem';
          a.style.fontWeight = '600';
          a.style.position = 'relative';
          a.style.zIndex = '3';
          modelInfo.appendChild(a);
        }
      });
    }

    infoCell.appendChild(modelInfo);
    infoLink.appendChild(infoCell);
    infoWrap.appendChild(infoLink);

    return [photoWrap, infoWrap];
  }

  // Añade al DOM
  modelos.forEach(m => {
    const [p, i] = createModelCells(m);
    gallery.appendChild(p);
    gallery.appendChild(i);
  });

  // Lazy-loading con IntersectionObserver
  const lazyImgs = [].slice.call(document.querySelectorAll('img.lazy'));
  if ('IntersectionObserver' in window) {
    const io = new IntersectionObserver((entries, observer) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const img = entry.target;
          if (img.dataset.src) {
            const real = img.dataset.src;
            img.src = real;
            // quitar atributo para indicar que se inició la carga
            img.removeAttribute('data-src');
            // si la imagen ya estaba en caché y está completa, llamar al handler
            if (img.complete) {
              img.dispatchEvent(new Event('load'));
            }
          }
          // observer ya no necesita observar
          observer.unobserve(img);
        }
      });
    }, {rootMargin: '200px 0px'});

    lazyImgs.forEach(img => io.observe(img));
  } else {
    // Fallback: cargar todas de inmediato
    lazyImgs.forEach(img => {
      if (img.dataset.src) {
        img.src = img.dataset.src;
        img.removeAttribute('data-src');
      }
    });
  }

  // Filtro de género (ya usando elementos dinámicos)
  const btnMujeres = document.getElementById('btnMujeres');
  const btnHombres = document.getElementById('btnHombres');

  function filterGenero(genero) {
    document.querySelectorAll('.gallery-2x2 .cell-genero').forEach(cell => {
      cell.style.display = (cell.getAttribute('data-genero') === genero) ? '' : 'none';
    });
  }

  if (btnMujeres && btnHombres) {
    btnMujeres.addEventListener('click', () => {
      filterGenero('mujer');
      btnMujeres.classList.add('bg-white','text-black');
      btnMujeres.classList.remove('bg-black','text-white');
      btnHombres.classList.remove('bg-white','text-black');
      btnHombres.classList.add('bg-black','text-white');
    });

    btnHombres.addEventListener('click', () => {
      filterGenero('hombre');
      btnHombres.classList.add('bg-white','text-black');
      btnHombres.classList.remove('bg-black','text-white');
      btnMujeres.classList.remove('bg-white','text-black');
      btnMujeres.classList.add('bg-black','text-white');
    });

    // Mostrar mujeres por defecto
    btnMujeres.click();
  }
})();
</script>
    <div class="max-w-screen-xl mx-auto px-4 flex flex-col md:flex-row items-center justify-between">
        <div class="mb-4 md:mb-0 text-center md:text-left">
            &copy; 2025 THE MODEL ISSUE. Todos los derechos reservados.
        </div>
        <div class="flex space-x-4 justify-center">
            <a href="https://instagram.com/themodelissue" target="_blank" title="Instagram" class="hover:text-pink-400">
                <i class="fab fa-instagram fa-lg"></i>
            </a>
            <a href="https://wa.me/584128703811" target="_blank" title="WhatsApp" class="hover:text-green-400">
                <i class="fab fa-whatsapp fa-lg"></i>
            </a>
        </div>
    </div>
</footer>
</body>

</html>